SELECT product_id, order_date,
LAG (order_date,1) OVER (ORDER BY order_date) AS prev_order_date
FROM orders;

/*
ORDER_DATE	PRODUCT_ID	QTY
2007/09/25	1000		20
2007/09/26	2000		15
2007/09/27	1000		8
2007/09/28	2000		12
2007/09/29	2000		2
2007/09/30	1000		4


***RESULT***
PRODUCT_ID	ORDER_DATE	PREV_ORDER_DATE
1000		2007/09/25	NULL
2000		2007/09/26	2007/09/25
1000		2007/09/27	2007/09/26
2000		2007/09/28	2007/09/27
2000		2007/09/29	2007/09/28
1000		2007/09/30	2007/09/29

*/

---------------Using Partitions--------------------

SELECT product_id, order_date,
LAG (order_date,1) OVER (PARTITION BY product_id ORDER BY order_date) AS prev_order_date
FROM orders;

/*
***RESULT***
PRODUCT_ID	ORDER_DATE	PREV_ORDER_DATE
1000		2007/09/25	NULL
1000		2007/09/27	2007/09/25
1000		2007/09/30	2007/09/27
2000		2007/09/26	NULL
2000		2007/09/28	2007/09/26
2000		2007/09/29	2007/09/28


*/